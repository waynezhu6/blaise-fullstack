(this["webpackJsonpblaise-fullstack"]=this["webpackJsonpblaise-fullstack"]||[]).push([[0],{11:function(e,t,n){e.exports={body:"Overlay_body__31SYO",filter:"Overlay_filter__9tSQJ",title:"Overlay_title__UQnP3",info:"Overlay_info__360ia",checkbox:"Overlay_checkbox__1ySMi"}},36:function(e,t,n){e.exports={body:"Map_body__2zHHP"}},42:function(e,t,n){},43:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(34),a=n.n(c),i=(n(42),n(43),n(12)),u=n(7),s=n.n(u),l=n(37),f=n(9),d=n(8),b=n(22),j=n(70),p=n(5),O=function(e){var t=e.size,n=void 0===t?20:t,r=e.fill,o={fill:void 0===r?"#DD0000":r,stroke:"none"};return Object(p.jsx)("svg",{height:n,viewBox:"0 0 24 24",style:o,children:Object(p.jsx)("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"})})},g=r.memo(O),v=(n(66),n(17)),x=n.n(v),h=n(36),m=n.n(h),y=n(11),k=n.n(y),w=function(e){var t=e.setLinear,n=e.from,o=e.to,c=Object(r.useRef)(),a=function(e){return"".concat(e.lon.toFixed(4),", ").concat(e.lat.toFixed(4))};return Object(p.jsx)("div",{className:k.a.body,onClick:function(e){return e.stopPropagation()},children:Object(p.jsxs)("div",{className:k.a.filter,children:[Object(p.jsx)("div",{className:k.a.title,children:"Blaise Coding Challenge"}),Object(p.jsxs)("div",{className:k.a.info,style:{borderLeft:"4px solid #DD0000"},children:["From: ",a(n)]}),Object(p.jsxs)("div",{className:k.a.info,style:{borderLeft:"4px solid #766DB1"},children:["To: ",a(o)]}),Object(p.jsxs)("div",{className:k.a.checkbox,children:[Object(p.jsx)("span",{onClick:function(){c.current&&(c.current.checked=!c.current.checked)},children:"View full walking route"}),Object(p.jsx)("input",{type:"checkbox",ref:c,onClick:function(){if(c.current){var e=c.current.checked;t(!e)}},defaultChecked:!0})]})]})})},L=n(18),D=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.lon,",").concat(t.lat,";").concat(n.lon,",").concat(n.lat),"?geometries=geojson&overview=full",e.next=4,fetch("https://router.project-osrm.org/route/v1/driving/"+r+"?geometries=geojson&overview=full").then((function(e){return e.json()}));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_=function(e,t){return"".concat(e.lon.toFixed(3),",").concat(e.lat.toFixed(3),";")+"".concat(t.lon.toFixed(3),",").concat(t.lat.toFixed(3))},S=function(){var e=Object(r.useState)({}),t=Object(d.a)(e,2),n=t[0],o=t[1];return function(){var e=Object(f.a)(s.a.mark((function e(t,r){var c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((c=_(t,r))in n)){e.next=6;break}return console.log("memoized route"),e.abrupt("return",n[c]);case 6:return e.next=8,D(t,r);case 8:return a=e.sent,o(Object(i.a)(Object(i.a)({},n),{},Object(L.a)({},c,a.routes[0].geometry.coordinates))),e.abrupt("return",a.routes[0].geometry.coordinates);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};x.a.workerClass=n(67).default;var C=function(){var e=Object(r.useRef)(),t=Object(r.useState)({width:"100%",height:"100%",longitude:-79.3971,latitude:43.6597,zoom:12}),n=Object(d.a)(t,2),o=n[0],c=n[1],a=Object(r.useState)({lon:-79.3971,lat:43.6597}),u=Object(d.a)(a,2),O=u[0],v=u[1],x=Object(r.useState)({lon:-79.337409,lat:43.689225}),h=Object(d.a)(x,2),y=h[0],k=h[1],L=S(),D=Object(r.useState)(!1),_=Object(d.a)(D,2),C=_[0],F=_[1],N=Object(j.a)(C,300),T=Object(d.a)(N,1)[0],z=Object(r.useState)(Date.now()),B=Object(d.a)(z,2),E=B[0],M=B[1],I=Object(j.a)(E,300),A=Object(d.a)(I,1)[0];Object(r.useEffect)((function(){var t=e.current.getMap();console.log("loaded"),t.on("load",(function(){return P()}));var n=function(){return c(o)};return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[]),Object(r.useEffect)((function(){console.log("recalculating route..."),Y(),P()}),[A,T]);var J=function(){var e=Object(f.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=4;break}return e.abrupt("return",[[O.lon,O.lat],[y.lon,y.lat]]);case 4:return e.next=6,L(O,y);case 6:return t=e.sent,e.abrupt("return",[[O.lon,O.lat]].concat(Object(l.a)(t),[[y.lon,y.lat]]));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var t=Object(f.a)(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.current){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,J();case 4:n=t.sent;try{(r=e.current.getMap()).addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n}}}),r.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#00CCAD","line-width":4}})}catch(o){console.log(o)}case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Y=function(){var t=e.current.getMap();t.getLayer("route")&&(t.removeLayer("route"),t.removeSource("route"))};return Object(p.jsxs)("div",{className:m.a.body,children:[Object(p.jsx)(w,{setLinear:F,from:O,to:y}),Object(p.jsxs)(b.b,Object(i.a)(Object(i.a)({},o),{},{minZoom:1,maxZoom:16,onViewportChange:function(e){return c(e)},mapboxApiAccessToken:"pk.eyJ1Ijoid2F5bmV6IiwiYSI6ImNrbDdmN3BtcTJteWsyb3BsNGt0YmpnZmYifQ.A-To5_8sa_6FqSTUW5TG1g",ref:e,children:[Object(p.jsx)(b.a,{longitude:O.lon,latitude:O.lat,draggable:!0,offsetTop:-40,offsetLeft:-20,onDragStart:function(){return Y()},onDrag:function(e){return v({lon:e.lngLat[0],lat:e.lngLat[1]})},onDragEnd:function(e){v({lon:e.lngLat[0],lat:e.lngLat[1]}),M(Date.now())},children:Object(p.jsx)(g,{size:40,fill:"#DD0000"})}),Object(p.jsx)(b.a,{longitude:y.lon,latitude:y.lat,draggable:!0,offsetTop:-40,offsetLeft:-20,onDragStart:function(){return Y()},onDrag:function(e){return k({lon:e.lngLat[0],lat:e.lngLat[1]})},onDragEnd:function(e){k({lon:e.lngLat[0],lat:e.lngLat[1]}),M(Date.now())},children:Object(p.jsx)(g,{size:40,fill:"#766DB1"})})]}))]})},F=function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(C,{})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,71)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))};a.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(F,{})}),document.getElementById("root")),N()}},[[68,1,2]]]);
//# sourceMappingURL=main.64bff615.chunk.js.map